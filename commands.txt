helm list

kubectl create namespace m

# ingress
helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx/
helm repo update
helm upgrade --install nginx ingress-nginx/ingress-nginx --namespace default -f "./.helm/external-values/nginx-ingress.yaml"
helm upgrade --install postgres oci://registry-1.docker.io/bitnamicharts/postgresql --namespace m  -f  "./.helm/external-values/postgres.yaml"
# postgres
helm install postgres oci://registry-1.docker.io/bitnamicharts/postgresql --namespace m  -f  "./.helm/values/postgres.yaml"

psql -h postgres-postgresql.m.svc.cluster.local -p 5432 -U postgres -d service_1
psql -h postgres-postgresql.m.svc.cluster.local -p 5432 -U postgres-postgresql -d service_1 -Ppostgres



kubectl run postgres-postgresql-client --rm --tty -i --restart='Never' --namespace m --image docker.io/bitnami/postgresql:15.2.0-debian-12-r10 --env="PGPASSWORD=postgres_pass" \
      --command -- psql --host postgres-postgresql -U postgres -d postgres -p 5432


kubectl run app-postgres-postgresql-client --rm --tty -i --restart='Never' --namespace m --image docker.io/bitnami/postgresql:16.2.0-debian-12-r10 --env="PGPASSWORD=postgres_pass" --command -- psql --host app-postgres-postgresql -U postgres -d service_1 -p 5432


kubectl port-forward --namespace m svc/app-postgres-postgresql 5432:5432 & PGPASSWORD="postgres_pass" psql --host 127.0.0.1 -U postgres -d service_1 -p 5432

kubectl port-forward --namespace m svc/app-postgres-postgresql 5432:5432 & PGPASSWORD="$POSTGRES_PASSWORD" psql --host 127.0.0.1 -U postgres -d service_1 -p 5432


export POSTGRES_PASSWORD=$(kubectl get secret --namespace m postgres-secret -o jsonpath="{.data.password}" | base64)